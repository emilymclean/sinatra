amends "package://components.emilym.cl/actions/actions@0.1.12#/common/simple-gradle.pkl"

jobName = "test"
gradleTask = "testDebugUnitTest"
name = "Unit Test"

extraBuildSteps {
  new CommandStep {
    run = """
      printf "MAPS_API_KEY=${MAPS_API_KEY}" >> secrets.properties
      printf "${GOOGLE_SERVICES_JSON}" >> androidApp/google-services.json
      printf "apiUrl=${{vars.PRODUCTION_API_URL}" >> gradle.properties
      """
    env {
      ["MAPS_API_KEY"] = "${{ secrets.MAPS_API_KEY }}"
      ["GOOGLE_SERVICES_JSON"] = "${{ secrets.GOOGLE_SERVICES_JSON }}"
    }
  }
}

modules = List("shared", "ui")